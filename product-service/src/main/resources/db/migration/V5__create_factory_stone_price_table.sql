-- 공장별 스톤 조각료 관리 테이블
CREATE TABLE FACTORY_STONE_PRICE (
    FACTORY_STONE_PRICE_ID BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    FACTORY_ID BIGINT NOT NULL,
    FACTORY_NAME VARCHAR(255),
    STONE_ID BIGINT NOT NULL,
    ENGRAVING_FEE INTEGER NOT NULL,
    EFFECTIVE_DATE DATE NOT NULL,
    EXPIRED_DATE DATE,
    NOTE VARCHAR(500),
    CREATE_DATE TIMESTAMP,
    LAST_MODIFIED_DATE TIMESTAMP,
    CONSTRAINT FK_FACTORY_STONE_PRICE_STONE FOREIGN KEY (STONE_ID) REFERENCES STONE(STONE_ID),
    CONSTRAINT UK_FACTORY_STONE_DATE UNIQUE (FACTORY_ID, STONE_ID, EFFECTIVE_DATE)
);

-- 조회 성능을 위한 인덱스
CREATE INDEX IDX_FACTORY_STONE_PRICE_FACTORY ON FACTORY_STONE_PRICE(FACTORY_ID);
CREATE INDEX IDX_FACTORY_STONE_PRICE_STONE ON FACTORY_STONE_PRICE(STONE_ID);
CREATE INDEX IDX_FACTORY_STONE_PRICE_EFFECTIVE ON FACTORY_STONE_PRICE(EFFECTIVE_DATE);
