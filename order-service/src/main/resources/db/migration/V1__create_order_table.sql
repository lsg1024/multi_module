CREATE TABLE PRIORITY (
    PRIORITY_ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    PRIORITY_NAME VARCHAR(255) UNIQUE,
    PRIORITY_DATE INTEGER
);
-- 초기 데이터 삽입
INSERT INTO PRIORITY (PRIORITY_NAME, PRIORITY_DATE) VALUES ('일반', 7);
INSERT INTO PRIORITY (PRIORITY_NAME, PRIORITY_DATE) VALUES ('급', 5);
INSERT INTO PRIORITY (PRIORITY_NAME, PRIORITY_DATE) VALUES ('초급', 4);

-- ORDERS 테이블
CREATE TABLE ORDERS (
    ORDER_ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    ORDER_CODE VARCHAR(255),
    STORE_ID BIGINT,
    STORE_NAME VARCHAR(255),
    FACTORY_ID BIGINT,
    FACTORY_NAME VARCHAR(255),
    ORDER_NOTE VARCHAR(255),
    PRIORITY_ID BIGINT,
    PRODUCT_STATUS VARCHAR(50) NOT NULL,
    ORDER_STATUS VARCHAR(50) NOT NULL,
    ORDER_DATE TIMESTAMP,
    ORDER_EXPECT_DATE TIMESTAMP,
    ORDER_DELETED BOOLEAN DEFAULT FALSE,
    CONSTRAINT FK_ORDERS_PRIORITY FOREIGN KEY (PRIORITY_ID) REFERENCES PRIORITY(PRIORITY_ID)
);

CREATE INDEX IX_ORDERS_STATUS ON ORDERS (PRODUCT_STATUS, ORDER_STATUS);
CREATE INDEX IX_ORDERS_PRIORITY ON ORDERS (PRIORITY_ID);
CREATE INDEX IX_ORDERS_DATE ON ORDERS (ORDER_DATE);

-- ORDER_PRODUCT 테이블
CREATE TABLE ORDER_PRODUCT (
    ORDER_PRODUCT_ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    ORDER_ID BIGINT UNIQUE,
    PRODUCT_ID BIGINT,
    PRODUCT_NAME VARCHAR(255),
    PRODUCT_SIZE VARCHAR(50),
    PRODUCT_WEIGHT DECIMAL(8, 2),
    STONE_WEIGHT DECIMAL(8, 2),
    PRODUCT_LABOR_COST INT,
    PRODUCT_ADD_LABOR_COST INT,
    MATERIAL_NAME VARCHAR(100),
    CLASSIFICATION_NAME VARCHAR(100),
    COLOR_NAME VARCHAR(100),
    CONSTRAINT FK_ORDER_PRODUCT_ORDERS
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID)
);

-- ORDER_STONE 테이블
CREATE TABLE ORDER_STONE (
    ORDER_STONE_ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    ORIGIN_STONE_ID BIGINT,
    ORIGIN_STONE_NAME VARCHAR(255),
    ORIGIN_STONE_WEIGHT DECIMAL(8, 2),
    STONE_PURCHASE_PRICE INTEGER,
    STONE_LABOR_COST INTEGER,
    STONE_QUANTITY INTEGER,
    PRODUCT_STONE_MAIN BOOLEAN,
    INCLUDE_QUANTITY BOOLEAN,
    INCLUDE_WEIGHT BOOLEAN,
    INCLUDE_LABOR BOOLEAN,
    ORDER_ID BIGINT,
    CONSTRAINT FK_ORDER_STONE_ORDERS FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID)
);

-- STATUS_HISTORY 테이블
CREATE TABLE STATUS_HISTORY (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    PRODUCT_STATUS VARCHAR(50) NOT NULL,
    ORDER_STATUS VARCHAR(50) NOT NULL,
    CREATE_AT TIMESTAMP,
    USER_NAME VARCHAR(255),
    ORDER_ID BIGINT,
    CONSTRAINT FK_STATUS_HISTORY_ORDERS
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID)
);